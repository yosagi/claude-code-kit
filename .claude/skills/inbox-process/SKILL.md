---
name: inbox-process
description: inbox に届いた依頼を処理する（自動実行用）
user_invocable: true
allowed-tools: Bash(~/.claude/skills/inbox/inbox.sh:*)
---

# あなたのタスク: 指定された inbox 依頼を処理する

このスキルは `claude -p` による自動実行を想定しています。
指定されたファイル名の依頼を読み、内容に従って作業し、結果を報告してください。

**重要**: このタスクに関係のない作業（挨拶、雑談、他のタスク）は行わないでください。

## 処理手順

### 1. 依頼を読む

```bash
~/.claude/skills/inbox/inbox.sh read [指定されたファイル名]
```

これにより依頼内容が表示され、INDEX.md の `[NEW]` マーカーが削除されます。

### 2. 実装ログを作成

作業を開始する前に、CLAUDE.md の実装プロセスに従って実装ログを作成してください。

### 3. 依頼内容に従って作業を実行

依頼内容を理解し、指示された作業を実行してください。
作業中は実装ログに進捗を記録してください。

### 4. 依頼を完了

作業が終わったら（成功・失敗に関わらず）：

```bash
~/.claude/skills/inbox/inbox.sh done [ファイル名]
```

これにより依頼ファイルが `done/` に移動し、INDEX.md から削除されます。

### 5. 記憶ファイルを更新

実装ログに完了報告を記載し、work_history.md に作業内容と実装ログへの参照を追記してください。
フォーマットは CLAUDE.md の記憶ファイル更新ルールに従ってください。

### 6. 結果を報告

依頼に「報告先」が記載されている場合、**成功・失敗に関わらず**結果を送信元に返します。

```bash
~/.claude/skills/inbox/inbox.sh sendto [報告先プロジェクトルート] [draft ファイル] [送信元名] [日付]
```

**注意**: 報告先はプロジェクトルート（例: `~/work/myproject`）を指定する。
`/reports/inbox` は自動で追加される（含めても自動で正規化される）。

**成功時の draft フォーマット:**
```markdown
送信先: [報告先パス]

# 報告: [元の依頼タイトル] 完了

- **報告元**: [現在のプロジェクト名]（[人格名]）
- **元の依頼**: [依頼ファイル名]
- **ステータス**: 完了
- **実装ログ**: [実装ログのパス]

## 結果

[作業結果の要約]

## 詳細

[必要に応じて詳細情報]
```

**失敗時の draft フォーマット:**
```markdown
送信先: [報告先パス]

# 報告: [元の依頼タイトル] 失敗

- **報告元**: [現在のプロジェクト名]（[人格名]）
- **元の依頼**: [依頼ファイル名]
- **ステータス**: 失敗
- **実装ログ**: [実装ログのパス]

## 失敗理由

[なぜ作業を完了できなかったか]
- sandbox の制限により書き込みできなかった
- 必要なファイルが見つからなかった
- 依頼内容が不明確だった
- など

## 試みたこと

[どこまで作業を進めたか、何を試したか]
```

## 使用例

```bash
# claude -p から呼び出される想定
claude -p "/inbox-process 2026-02-05_from_claude_request.md を処理して"
```

## 注意事項

- **必ず報告する**: 成功・失敗に関わらず、報告先がある場合は必ず結果を送信する
- **記録を残す**: 実装ログと work_history.md を必ず更新する
- **sandbox 制限**: 自動実行時は sandbox 環境で実行されるため、書き込み可能なディレクトリが制限されている
- **部分的な成功**: 一部だけ完了できた場合は、完了した部分と未完了の部分を明確に報告する